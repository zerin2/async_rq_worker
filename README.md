# üß† Async RQ Worker

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Redis-–≤–æ—Ä–∫–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –∏–∑ –æ—á–µ—Ä–µ–¥–µ–π.
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–¥—ë–∂–Ω–æ–≥–æ –±—ç–∫–µ–Ω–¥–∞ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π 
–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–∞—Å—Ç–æ–º–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–¥–∞—á.

---

## üöÄ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –≤–æ—Ä–∫–µ—Ä –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:

- –ü–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á –∏–∑ Redis-–æ—á–µ—Ä–µ–¥–µ–π (`blpop`)
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏

---

## üß± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **Redis** ‚Äî –æ—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –æ–±—Ä–∞–±–æ—Ç–∫–∏.
- **FastAPI/DRF** ‚Äî –≤–Ω–µ—à–Ω–∏–π API –º–æ–∂–µ—Ç –∫–ª–∞—Å—Ç—å –∑–∞–¥–∞—á–∏ –≤ Redis.
- **async_rq_worker** ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏, –≤—ã–∑—ã–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é.
---
## üìå –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—á–µ—Ä–µ–¥–µ–π
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á
- –ì–∏–±–∫–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—É—Å–∫
- –õ—ë–≥–∫–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install -r requirements.txt
```

---

## üß™ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
import asyncio
from redis.asyncio import Redis
from init_worker import AsyncRQWorker

async def example_function(task_id: str, data: dict) -> None:
    print(f'–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á–∏ {task_id}: {data}')

worker = AsyncRQWorker(
    redis_client=Redis(host='localhost', port=6379, decode_responses=True),
    queue_names=['parsing_queue'],
    function=example_function,
)

asyncio.run(worker.run())
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—á–µ—Ä–µ–¥–∏ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω:

```python
queue_names=['parsing_queue']
```

–ö–∞–∂–¥–æ–µ –∏–º—è –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –≤ `'parsing_queue:processing'`.

---

## üßæ –õ–æ–≥–∏

–õ–æ–≥–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ. –ü—Ä–∏–º–µ—Ä:

```
–ü–æ–ª—É—á–µ–Ω–∞ –∑–∞–¥–∞—á–∞: func(example_function) data: ('parsing_queue:processing', '{...}')
–ü–µ—Ä–µ–¥–∞–Ω–∞ –∑–∞–¥–∞—á–∞: queue(parsing_queue:processing) task_id: abcd123456 data: {...}
```

---

## üîß –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è      | –í–µ—Ä—Å–∏—è         |
|-----------------|----------------|
| Python          | 3.10+          |
| Redis           | 6+             |
| redis-py        | ^5.x (async)   |
| Pydantic        | ^2.x           |

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ init_worker.py       # –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –≤–æ—Ä–∫–µ—Ä–∞
‚îú‚îÄ‚îÄ enums.py             # –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Å—Ç–∞—Ç—É—Å–æ–≤ –æ—á–µ—Ä–µ–¥–µ–π
‚îú‚îÄ‚îÄ README.md
```

---

## üì• –í—Å—Ç–∞–≤–∫–∞ –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥—å –≤—Ä—É—á–Ω—É—é

```python
await worker.set_task_in_queue(
    data={'account': '12345', 'utility': 'water'},
    queue_name='parsing_queue',
)
```

---